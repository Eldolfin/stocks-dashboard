FROM denoland/deno:2.4.4 AS builder
RUN apt-get update && apt-get install -y curl
WORKDIR /app
EXPOSE 3000
ENV NODE_ENV=production


COPY package.json deno.lock .
RUN deno install --allow-scripts=npm:@tailwindcss/oxide@4.1.11
COPY svelte.config.js .
RUN deno task prepare
COPY . .
RUN deno task build

CMD [ "deno", "--allow-env", "--allow-read", "--allow-net", "build/index.js" ]
HEALTHCHECK CMD curl -f -o /dev/null http://localhost:3000
